#include <cstdlib>
#include <iostream>
#include "Network.hpp"
#include "gradients.hpp"
#include "derivee.hpp"
#include "calcul_erreur.hpp"


using namespace std;

int main(int argc, char* argv[]){
    vector<int> neuronnes = {10, 3, 3};
    vector<function<Matrixld(const Matrixld&)>> activations = {sigmoid_m, sigmoid_m};
    vector<function<Matrixld(const Matrixld&)>> derivees = {dsigmoid, dsigmoid};
    vector<function<Matrixld(const Matrixld&,const Matrixld&,const Matrixld&)>> formule_gradient_W = {gradient_W_sigmoid_MSE,gradient_W_sigmoid_MSE};
    vector<function<RowVectorld(const Matrixld&,const Matrixld&)>> formule_gradient_B= {gradient_B_sigmoid_MSE,gradient_B_sigmoid_MSE};
    

    long double alpha = 0.03;
    int iter_max = 1000;
    long double eps = 0.001;
    bool affichage = true;
    bool stoch = false;
    if (argc > 1) {
        alpha = std::atof(argv[1]);  
    }
    if (argc > 2){
        iter_max = atoi(argv[2]);
    }
        if (argc > 3){
        eps = atof(argv[3]);
    }
    if (argc > 4){
        affichage = atoi(argv[4])==1;
    }
    if(argc > 5){
        stoch = atoi(argv[5])==1;
    }
    
    
    Network reseauXOR(neuronnes,activations,derivees,crossEntropy,stoch);

    
    Matrixld X(4,2);
    X << 0., 0.,
        0.,1.,
        1.,0.,
        1.,1.;
    
    Matrixld E(2,4);
    E << 1.,0.,0.,1.,
        0.,1.,1.,0.;

   

    //reseauXOR.train_full(X,E);
    



    RowVectorld t(2);
    t << 0.,0.;
    //cout << reseauXOR.predict(t)<<endl;
    t << 0.,1.;
    //cout << reseauXOR.predict(t) << endl;
    t << 1.,0.;
    //cout << reseauXOR.predict(t) << endl;
    t << 1.,1.;
    //cout << reseauXOR.predict(t) << endl;

    /*
    int save = 0;
    cout << "Sauvegarder le reseau : 1->oui" << endl;
    cin >> save;
    if (save == 1){
        reseauXOR.save_to_file("XOR.json");
    }
    */
    
    Matrixld X2(203,10);
    X2 << 0.36363636363636365 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,1.0 ,0.0 ,0.75 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,0.8333333333333334 ,1.0 ,0.0 ,0.75 ,
    0.5454545454545454 ,0.1111111111111111 ,1.0 ,0.0 ,0.07142857142857142 ,0.0 ,0.6333333333333333 ,0.8888888888888888 ,0.0 ,0.75 ,
    0.2727272727272727 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,1.0 ,0.041666666666666664 ,0.5 ,
    0.2727272727272727 ,0.2222222222222222 ,0.0 ,0.0 ,0.14285714285714285 ,0.0 ,1.0 ,0.6666666666666666 ,0.08333333333333333 ,0.75 ,
    0.5454545454545454 ,0.0 ,0.0 ,0.0 ,0.21428571428571427 ,0.0 ,1.0 ,1.0 ,0.041666666666666664 ,0.75 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.2857142857142857 ,0.0 ,1.0 ,1.0 ,0.125 ,0.75 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.21428571428571427 ,0.0 ,1.0 ,0.7777777777777778 ,0.16666666666666666 ,0.5 ,
    0.18181818181818182 ,0.3333333333333333 ,0.0 ,0.0 ,0.35714285714285715 ,0.0 ,1.0 ,0.3333333333333333 ,0.0 ,0.75 ,
    0.45454545454545453 ,0.1111111111111111 ,0.0 ,0.0 ,0.42857142857142855 ,0.0 ,0.5 ,1.0 ,0.20833333333333334 ,0.75 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.8888888888888888 ,0.041666666666666664 ,0.75 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.8888888888888888 ,0.08333333333333333 ,0.5 ,
    0.5454545454545454 ,0.4444444444444444 ,0.0 ,0.0 ,0.5 ,0.0 ,0.6333333333333333 ,1.0 ,0.0 ,0.5 ,
    0.18181818181818182 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.8888888888888888 ,0.08333333333333333 ,0.75 ,
    0.6363636363636364 ,0.1111111111111111 ,0.0 ,0.0 ,0.5 ,0.0 ,1.0 ,1.0 ,0.25 ,0.5 ,
    0.2727272727272727 ,0.1111111111111111 ,0.0 ,0.0 ,0.5 ,0.0 ,1.0 ,0.8888888888888888 ,0.2916666666666667 ,0.75 ,
    0.18181818181818182 ,0.3333333333333333 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.8888888888888888 ,0.3333333333333333 ,0.5 ,
    0.45454545454545453 ,0.0 ,1.0 ,0.0 ,0.21428571428571427 ,0.0 ,1.0 ,0.8888888888888888 ,0.08333333333333333 ,0.75 ,
    0.6363636363636364 ,0.0 ,0.0 ,0.0 ,0.5 ,0.0 ,0.4666666666666667 ,1.0 ,0.375 ,0.75 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.2222222222222222 ,0.3333333333333333 ,0.75 ,
    0.45454545454545453 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,1.0 ,1.0 ,0.4166666666666667 ,1.0 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.8888888888888888 ,0.125 ,0.5 ,
    0.09090909090909091 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.7777777777777778 ,0.4583333333333333 ,0.75 ,
    0.5454545454545454 ,0.5555555555555556 ,0.0 ,0.0 ,0.0 ,0.0 ,0.8333333333333334 ,1.0 ,0.125 ,0.75 ,
    0.45454545454545453 ,0.6666666666666666 ,0.0 ,0.0 ,0.5 ,0.0 ,1.0 ,1.0 ,0.3333333333333333 ,0.75 ,
    0.5454545454545454 ,0.6666666666666666 ,0.0 ,0.0 ,0.5 ,0.0 ,0.7666666666666667 ,1.0 ,0.3333333333333333 ,0.75 ,
    0.7272727272727273 ,0.7777777777777778 ,1.0 ,0.0 ,0.5 ,0.0 ,0.9 ,1.0 ,0.041666666666666664 ,0.75 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.21428571428571427 ,0.0 ,0.9666666666666667 ,0.8888888888888888 ,0.25 ,0.75 ,
    0.45454545454545453 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.8888888888888888 ,0.5 ,0.75 ,
    1.0 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,0.8666666666666667 ,0.8888888888888888 ,0.5416666666666666 ,0.75 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,1.0 ,1.0 ,0.125 ,0.5 ,
    0.18181818181818182 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.8888888888888888 ,0.08333333333333333 ,0.75 ,
    0.36363636363636365 ,0.2222222222222222 ,0.0 ,0.0 ,0.5 ,0.0 ,1.0 ,1.0 ,0.041666666666666664 ,0.75 ,
    0.5454545454545454 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.0 ,0.9666666666666667 ,1.0 ,0.3333333333333333 ,0.75 ,
    0.6363636363636364 ,0.1111111111111111 ,0.0 ,0.0 ,0.42857142857142855 ,0.0 ,0.5 ,1.0 ,0.5 ,0.5 ,
    0.45454545454545453 ,0.4444444444444444 ,0.0 ,0.0 ,0.07142857142857142 ,0.125 ,0.7 ,1.0 ,0.08333333333333333 ,0.75 ,
    0.2727272727272727 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.8888888888888888 ,0.0 ,0.5 ,
    0.45454545454545453 ,0.0 ,1.0 ,0.0 ,0.5714285714285714 ,0.0 ,0.9666666666666667 ,0.8888888888888888 ,0.08333333333333333 ,0.75 ,
    0.36363636363636365 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.8888888888888888 ,0.5833333333333334 ,0.75 ,
    0.36363636363636365 ,0.1111111111111111 ,0.0 ,0.0 ,0.35714285714285715 ,0.0 ,0.9333333333333333 ,0.6666666666666666 ,0.2916666666666667 ,0.5 ,
    0.36363636363636365 ,0.4444444444444444 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.8888888888888888 ,0.625 ,0.75 ,
    0.5454545454545454 ,0.8888888888888888 ,1.0 ,0.0 ,0.5 ,0.0 ,1.0 ,1.0 ,0.4583333333333333 ,0.75 ,
    0.18181818181818182 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.0 ,0.4 ,0.8888888888888888 ,0.16666666666666666 ,0.25 ,
    0.2727272727272727 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.8888888888888888 ,0.16666666666666666 ,0.75 ,
    0.8181818181818182 ,0.6666666666666666 ,0.0 ,0.0 ,0.6428571428571429 ,0.0 ,0.6333333333333333 ,0.8888888888888888 ,0.4583333333333333 ,0.5 ,
    0.2727272727272727 ,0.4444444444444444 ,0.0 ,0.0 ,0.14285714285714285 ,0.0 ,1.0 ,0.4444444444444444 ,0.041666666666666664 ,0.75 ,
    0.6363636363636364 ,0.1111111111111111 ,0.0 ,0.0 ,0.6428571428571429 ,0.125 ,0.5 ,0.7777777777777778 ,0.08333333333333333 ,0.75 ,
    0.18181818181818182 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,1.0 ,1.0 ,0.4583333333333333 ,0.75 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.21428571428571427 ,0.0 ,0.9666666666666667 ,0.8888888888888888 ,0.4166666666666667 ,0.75 ,
    0.36363636363636365 ,0.5555555555555556 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,1.0 ,0.3333333333333333 ,0.75 ,
    0.36363636363636365 ,0.1111111111111111 ,1.0 ,0.0 ,0.5 ,0.0 ,1.0 ,1.0 ,0.3333333333333333 ,0.75 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.8888888888888888 ,0.041666666666666664 ,0.75 ,
    0.45454545454545453 ,0.0 ,1.0 ,0.0 ,0.21428571428571427 ,0.0 ,1.0 ,1.0 ,0.041666666666666664 ,0.5 ,
    0.45454545454545453 ,0.4444444444444444 ,0.0 ,1.0 ,0.5 ,0.125 ,0.6333333333333333 ,1.0 ,0.041666666666666664 ,0.75 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,0.9333333333333333 ,0.8888888888888888 ,0.125 ,0.5 ,
    0.45454545454545453 ,0.6666666666666666 ,0.0 ,0.0 ,0.5 ,0.0 ,0.7333333333333333 ,1.0 ,0.6666666666666666 ,0.75 ,
    0.36363636363636365 ,0.4444444444444444 ,0.0 ,0.0 ,0.6428571428571429 ,0.0 ,1.0 ,0.6666666666666666 ,0.0 ,0.5 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.21428571428571427 ,0.0 ,0.9666666666666667 ,0.8888888888888888 ,0.7083333333333334 ,0.75 ,
    0.36363636363636365 ,0.1111111111111111 ,0.0 ,0.0 ,0.5 ,0.0 ,1.0 ,0.8888888888888888 ,0.5833333333333334 ,0.75 ,
    0.2727272727272727 ,0.5555555555555556 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.8888888888888888 ,0.7083333333333334 ,0.75 ,
    0.36363636363636365 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,1.0 ,0.041666666666666664 ,0.5 ,
    0.18181818181818182 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.8888888888888888 ,0.08333333333333333 ,0.75 ,
    0.5454545454545454 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.7777777777777778 ,0.0 ,0.5 ,
    0.36363636363636365 ,0.5555555555555556 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.8888888888888888 ,0.08333333333333333 ,0.75 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,0.9666666666666667 ,0.8888888888888888 ,0.08333333333333333 ,0.75 ,
    0.36363636363636365 ,0.5555555555555556 ,0.0 ,0.0 ,0.0 ,0.125 ,0.8 ,1.0 ,0.08333333333333333 ,0.75 ,
    0.45454545454545453 ,0.2222222222222222 ,1.0 ,0.0 ,0.7142857142857143 ,0.0 ,1.0 ,0.4444444444444444 ,0.2916666666666667 ,0.75 ,
    0.36363636363636365 ,0.5555555555555556 ,0.0 ,0.0 ,0.0 ,0.0 ,0.9666666666666667 ,0.7777777777777778 ,0.4166666666666667 ,0.75 ,
    0.45454545454545453 ,0.7777777777777778 ,0.0 ,0.0 ,0.5 ,0.125 ,0.4666666666666667 ,1.0 ,0.08333333333333333 ,0.75 ,
    0.36363636363636365 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.8888888888888888 ,0.75 ,0.75 ,
    0.5454545454545454 ,0.1111111111111111 ,0.0 ,0.0 ,0.5 ,0.0 ,0.0 ,1.0 ,0.7083333333333334 ,0.5 ,
    0.2727272727272727 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.6666666666666666 ,0.625 ,0.75 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,1.0 ,1.0 ,0.041666666666666664 ,0.5 ,
    0.7272727272727273 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.0 ,0.4 ,0.8888888888888888 ,0.20833333333333334 ,0.5 ,
    0.45454545454545453 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,1.0 ,0.08333333333333333 ,0.75 ,
    0.2727272727272727 ,0.7777777777777778 ,0.0 ,0.0 ,0.7857142857142857 ,0.0 ,1.0 ,1.0 ,0.041666666666666664 ,0.75 ,
    0.45454545454545453 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.8888888888888888 ,0.08333333333333333 ,0.75 ,
    0.36363636363636365 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,1.0 ,0.3333333333333333 ,0.75 ,
    0.8181818181818182 ,0.0 ,1.0 ,0.0 ,0.0 ,0.0 ,0.8333333333333334 ,0.8888888888888888 ,0.3333333333333333 ,0.75 ,
    0.45454545454545453 ,0.1111111111111111 ,0.0 ,0.0 ,0.5 ,0.0 ,0.9 ,1.0 ,0.5416666666666666 ,0.75 ,
    0.5454545454545454 ,0.0 ,0.0 ,0.0 ,0.5 ,0.0 ,0.03333333333333333 ,0.8888888888888888 ,0.375 ,0.5 ,
    0.7272727272727273 ,0.1111111111111111 ,0.0 ,0.0 ,0.07142857142857142 ,0.0 ,0.6 ,1.0 ,0.7083333333333334 ,0.75 ,
    0.36363636363636365 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,1.0 ,0.041666666666666664 ,0.75 ,
    0.18181818181818182 ,0.1111111111111111 ,0.0 ,0.0 ,0.5 ,0.125 ,0.43333333333333335 ,1.0 ,0.041666666666666664 ,0.5 ,
    0.7272727272727273 ,0.1111111111111111 ,0.0 ,0.0 ,0.5 ,0.0 ,0.5 ,1.0 ,0.0 ,0.75 ,
    0.45454545454545453 ,0.6666666666666666 ,0.0 ,0.0 ,0.07142857142857142 ,0.125 ,0.6333333333333333 ,0.8888888888888888 ,0.041666666666666664 ,0.5 ,
    0.36363636363636365 ,0.1111111111111111 ,0.0 ,0.0 ,0.5 ,0.125 ,0.4666666666666667 ,1.0 ,0.625 ,0.75 ,
    0.5454545454545454 ,0.0 ,0.0 ,0.0 ,0.0 ,0.75 ,0.9666666666666667 ,0.2222222222222222 ,0.7916666666666666 ,0.5 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.35714285714285715 ,0.75 ,0.9666666666666667 ,0.2222222222222222 ,0.041666666666666664 ,0.5 ,
    0.45454545454545453 ,0.0 ,0.0 ,0.0 ,0.21428571428571427 ,0.625 ,0.9666666666666667 ,0.3333333333333333 ,0.08333333333333333 ,0.5 ,
    0.09090909090909091 ,0.0 ,1.0 ,0.0 ,0.0 ,0.625 ,0.9666666666666667 ,0.2222222222222222 ,0.0 ,0.5 ,
    0.18181818181818182 ,0.0 ,0.0 ,0.0 ,0.0 ,0.75 ,0.9333333333333333 ,0.3333333333333333 ,0.7083333333333334 ,0.5 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.0 ,0.875 ,0.9666666666666667 ,0.2222222222222222 ,0.125 ,0.5 ,
    0.7272727272727273 ,0.0 ,1.0 ,0.0 ,0.0 ,0.5 ,0.9666666666666667 ,0.6666666666666666 ,0.5 ,0.5 ,
    0.18181818181818182 ,0.0 ,1.0 ,0.0 ,0.0 ,0.5 ,1.0 ,0.7777777777777778 ,0.041666666666666664 ,0.75 ,
    0.36363636363636365 ,1.0 ,1.0 ,0.0 ,0.0 ,1.0 ,0.9666666666666667 ,0.1111111111111111 ,0.041666666666666664 ,0.75 ,
    0.36363636363636365 ,0.0 ,0.0 ,0.0 ,0.7142857142857143 ,1.0 ,0.9333333333333333 ,0.1111111111111111 ,0.4166666666666667 ,0.75 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.7142857142857143 ,0.875 ,1.0 ,0.1111111111111111 ,0.4583333333333333 ,0.75 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.5 ,0.9333333333333333 ,0.7777777777777778 ,0.20833333333333334 ,0.5 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.0 ,0.875 ,0.9666666666666667 ,0.4444444444444444 ,0.0 ,0.75 ,
    0.18181818181818182 ,0.0 ,1.0 ,0.0 ,0.7142857142857143 ,0.625 ,1.0 ,0.1111111111111111 ,0.0 ,0.25 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.375 ,0.9333333333333333 ,0.7777777777777778 ,0.4583333333333333 ,0.75 ,
    0.09090909090909091 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,1.0 ,0.2222222222222222 ,0.7916666666666666 ,0.5 ,
    0.45454545454545453 ,0.0 ,1.0 ,0.0 ,0.5714285714285714 ,1.0 ,0.9 ,0.4444444444444444 ,0.125 ,0.75 ,
    0.09090909090909091 ,0.0 ,1.0 ,0.0 ,0.0 ,0.5 ,1.0 ,0.8888888888888888 ,0.041666666666666664 ,0.5 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.375 ,0.9666666666666667 ,0.7777777777777778 ,0.0 ,0.5 ,
    0.5454545454545454 ,0.0 ,1.0 ,0.0 ,0.0 ,0.5 ,1.0 ,0.6666666666666666 ,0.4583333333333333 ,0.5 ,
    0.45454545454545453 ,0.0 ,0.0 ,0.0 ,0.0 ,0.25 ,0.9333333333333333 ,0.7777777777777778 ,0.08333333333333333 ,0.75 ,
    0.18181818181818182 ,0.0 ,1.0 ,0.0 ,0.0 ,0.5 ,1.0 ,0.8888888888888888 ,0.0 ,0.5 ,
    0.09090909090909091 ,0.0 ,1.0 ,0.0 ,0.0 ,0.5 ,1.0 ,0.6666666666666666 ,0.08333333333333333 ,0.5 ,
    0.18181818181818182 ,0.0 ,1.0 ,0.0 ,0.0 ,0.75 ,0.9666666666666667 ,0.3333333333333333 ,0.125 ,0.5 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.0 ,0.5 ,1.0 ,0.8888888888888888 ,0.08333333333333333 ,0.75 ,
    0.09090909090909091 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,0.9666666666666667 ,0.2222222222222222 ,0.8333333333333334 ,0.5 ,
    0.45454545454545453 ,0.0 ,1.0 ,0.0 ,0.0 ,0.5 ,1.0 ,0.4444444444444444 ,0.125 ,0.5 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.375 ,1.0 ,0.2222222222222222 ,0.7083333333333334 ,0.75 ,
    0.36363636363636365 ,1.0 ,0.0 ,0.0 ,0.21428571428571427 ,0.875 ,1.0 ,0.1111111111111111 ,0.8333333333333334 ,0.5 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.25 ,1.0 ,0.6666666666666666 ,0.08333333333333333 ,0.5 ,
    0.18181818181818182 ,0.0 ,1.0 ,0.0 ,0.7142857142857143 ,1.0 ,1.0 ,0.0 ,0.08333333333333333 ,0.75 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.7142857142857143 ,0.75 ,1.0 ,0.1111111111111111 ,0.4583333333333333 ,0.75 ,
    0.18181818181818182 ,0.0 ,0.0 ,0.0 ,0.0 ,0.875 ,1.0 ,0.0 ,0.4166666666666667 ,0.5 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.0 ,0.875 ,1.0 ,0.1111111111111111 ,0.16666666666666666 ,0.5 ,
    0.18181818181818182 ,0.3333333333333333 ,1.0 ,0.0 ,0.7142857142857143 ,0.875 ,1.0 ,0.1111111111111111 ,0.7083333333333334 ,0.5 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.0 ,0.875 ,0.9666666666666667 ,0.1111111111111111 ,0.0 ,0.5 ,
    0.18181818181818182 ,0.0 ,1.0 ,0.0 ,0.7142857142857143 ,0.75 ,1.0 ,0.1111111111111111 ,0.5833333333333334 ,0.25 ,
    0.45454545454545453 ,0.0 ,0.0 ,0.0 ,0.35714285714285715 ,1.0 ,0.9 ,0.2222222222222222 ,0.25 ,0.75 ,
    0.09090909090909091 ,0.0 ,1.0 ,0.0 ,0.0 ,0.625 ,0.9333333333333333 ,0.3333333333333333 ,0.3333333333333333 ,0.5 ,
    0.18181818181818182 ,0.0 ,1.0 ,0.0 ,0.0 ,0.5 ,1.0 ,0.7777777777777778 ,0.7083333333333334 ,0.75 ,
    0.18181818181818182 ,0.0 ,1.0 ,0.0 ,0.0 ,0.75 ,0.9666666666666667 ,0.3333333333333333 ,0.7916666666666666 ,0.5 ,
    0.18181818181818182 ,0.0 ,1.0 ,0.0 ,0.7142857142857143 ,0.625 ,0.9666666666666667 ,0.8888888888888888 ,0.3333333333333333 ,0.75 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.75 ,0.9666666666666667 ,0.4444444444444444 ,0.6666666666666666 ,0.5 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.5 ,1.0 ,0.6666666666666666 ,0.16666666666666666 ,0.75 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.5 ,1.0 ,0.7777777777777778 ,0.0 ,0.5 ,
    0.7272727272727273 ,0.0 ,1.0 ,0.0 ,0.7142857142857143 ,0.875 ,0.9333333333333333 ,0.2222222222222222 ,0.0 ,0.75 ,
    0.0 ,0.0 ,1.0 ,0.0 ,0.7142857142857143 ,0.625 ,1.0 ,0.1111111111111111 ,0.875 ,0.5 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.25 ,1.0 ,0.7777777777777778 ,0.125 ,0.5 ,
    0.09090909090909091 ,0.4444444444444444 ,0.0 ,0.0 ,0.7142857142857143 ,0.875 ,1.0 ,0.0 ,0.3333333333333333 ,0.0 ,
    0.5454545454545454 ,0.0 ,1.0 ,0.0 ,0.0 ,0.375 ,0.9666666666666667 ,0.5555555555555556 ,0.125 ,0.75 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.75 ,1.0 ,0.8888888888888888 ,0.0 ,0.5 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.75 ,0.9666666666666667 ,0.2222222222222222 ,0.125 ,0.5 ,
    0.09090909090909091 ,0.0 ,1.0 ,0.0 ,0.7142857142857143 ,0.875 ,1.0 ,0.1111111111111111 ,0.08333333333333333 ,0.25 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.625 ,0.9333333333333333 ,0.3333333333333333 ,0.0 ,0.5 ,
    0.18181818181818182 ,0.0 ,1.0 ,0.0 ,0.8571428571428571 ,0.75 ,1.0 ,0.2222222222222222 ,0.875 ,0.5 ,
    0.18181818181818182 ,0.0 ,1.0 ,0.0 ,0.0 ,0.625 ,0.9333333333333333 ,0.6666666666666666 ,0.4166666666666667 ,0.5 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.0 ,0.625 ,1.0 ,0.5555555555555556 ,0.125 ,0.75 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.25 ,1.0 ,0.6666666666666666 ,0.08333333333333333 ,0.5 ,
    0.45454545454545453 ,0.0 ,0.0 ,0.0 ,0.0 ,0.875 ,0.9666666666666667 ,0.1111111111111111 ,0.4583333333333333 ,0.75 ,
    0.09090909090909091 ,0.0 ,1.0 ,0.0 ,0.8571428571428571 ,0.75 ,1.0 ,0.2222222222222222 ,0.041666666666666664 ,0.5 ,
    0.09090909090909091 ,0.0 ,1.0 ,0.0 ,0.7142857142857143 ,0.5 ,0.9666666666666667 ,0.6666666666666666 ,0.20833333333333334 ,0.75 ,
    0.09090909090909091 ,0.0 ,1.0 ,0.0 ,0.0 ,1.0 ,0.9666666666666667 ,0.2222222222222222 ,0.4166666666666667 ,0.5 ,
    0.8181818181818182 ,0.0 ,1.0 ,0.0 ,0.21428571428571427 ,0.875 ,1.0 ,0.2222222222222222 ,0.041666666666666664 ,0.5 ,
    0.2727272727272727 ,0.0 ,0.0 ,0.0 ,0.7142857142857143 ,0.875 ,1.0 ,0.2222222222222222 ,0.0 ,0.5 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.7142857142857143 ,0.875 ,1.0 ,0.1111111111111111 ,0.20833333333333334 ,0.5 ,
    0.45454545454545453 ,0.0 ,1.0 ,0.0 ,0.0 ,1.0 ,0.9333333333333333 ,0.1111111111111111 ,0.4583333333333333 ,0.5 ,
    0.2727272727272727 ,0.0 ,1.0 ,0.0 ,0.8571428571428571 ,0.375 ,1.0 ,0.7777777777777778 ,0.125 ,0.25 ,
    0.18181818181818182 ,0.0 ,1.0 ,0.0 ,0.7142857142857143 ,0.875 ,1.0 ,0.1111111111111111 ,0.08333333333333333 ,0.5 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.375 ,1.0 ,0.7777777777777778 ,0.08333333333333333 ,0.75 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.7142857142857143 ,0.75 ,1.0 ,0.2222222222222222 ,0.0 ,0.5 ,
    0.45454545454545453 ,0.0 ,1.0 ,0.0 ,0.0 ,0.375 ,1.0 ,0.2222222222222222 ,0.2916666666666667 ,0.5 ,
    0.18181818181818182 ,0.0 ,0.0 ,0.0 ,0.0 ,1.0 ,1.0 ,0.1111111111111111 ,0.4583333333333333 ,0.5 ,
    0.45454545454545453 ,0.6666666666666666 ,0.0 ,0.0 ,0.0 ,0.375 ,0.8 ,0.8888888888888888 ,0.4166666666666667 ,0.75 ,
    0.2727272727272727 ,0.1111111111111111 ,0.0 ,0.0 ,0.5 ,0.0 ,0.8 ,0.8888888888888888 ,0.8333333333333334 ,0.75 ,
    0.5454545454545454 ,0.6666666666666666 ,0.0 ,0.0 ,0.07142857142857142 ,0.0 ,1.0 ,1.0 ,0.125 ,0.75 ,
    0.5454545454545454 ,0.5555555555555556 ,0.0 ,0.0 ,0.0 ,0.75 ,0.9333333333333333 ,0.2222222222222222 ,0.4583333333333333 ,0.5 ,
    0.7272727272727273 ,0.6666666666666666 ,0.0 ,0.0 ,0.07142857142857142 ,0.25 ,0.9 ,1.0 ,0.5833333333333334 ,0.75 ,
    0.36363636363636365 ,0.6666666666666666 ,0.0 ,0.0 ,0.7857142857142857 ,0.625 ,0.8666666666666667 ,0.4444444444444444 ,0.0 ,0.5 ,
    0.5454545454545454 ,0.6666666666666666 ,0.0 ,0.0 ,0.5 ,0.125 ,0.7666666666666667 ,0.8888888888888888 ,0.08333333333333333 ,0.5 ,
    0.45454545454545453 ,0.6666666666666666 ,0.0 ,0.0 ,0.0 ,0.625 ,1.0 ,0.2222222222222222 ,0.25 ,0.5 ,
    0.36363636363636365 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.625 ,0.9333333333333333 ,0.1111111111111111 ,0.625 ,0.5 ,
    0.6363636363636364 ,0.0 ,1.0 ,0.0 ,0.5 ,0.0 ,0.7666666666666667 ,1.0 ,0.875 ,0.75 ,
    0.2727272727272727 ,0.1111111111111111 ,1.0 ,0.0 ,0.5 ,0.125 ,1.0 ,0.8888888888888888 ,0.0 ,0.75 ,
    0.18181818181818182 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.75 ,1.0 ,0.6666666666666666 ,0.75 ,0.5 ,
    0.6363636363636364 ,0.5555555555555556 ,0.0 ,1.0 ,0.5 ,0.125 ,0.7666666666666667 ,1.0 ,0.4583333333333333 ,0.75 ,
    0.5454545454545454 ,0.1111111111111111 ,0.0 ,0.0 ,0.9285714285714286 ,0.875 ,0.8666666666666667 ,0.4444444444444444 ,0.375 ,0.5 ,
    0.18181818181818182 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.75 ,0.9333333333333333 ,0.6666666666666666 ,0.5 ,0.5 ,
    0.45454545454545453 ,0.6666666666666666 ,0.0 ,0.0 ,0.5 ,0.5 ,0.9333333333333333 ,1.0 ,0.16666666666666666 ,0.75 ,
    0.45454545454545453 ,0.1111111111111111 ,0.0 ,0.0 ,0.07142857142857142 ,0.125 ,0.5333333333333333 ,1.0 ,0.0 ,0.75 ,
    0.5454545454545454 ,0.1111111111111111 ,0.0 ,0.0 ,0.07142857142857142 ,0.25 ,0.6333333333333333 ,1.0 ,0.6666666666666666 ,0.75 ,
    1.0 ,0.6666666666666666 ,0.0 ,0.0 ,0.0 ,0.75 ,0.8333333333333334 ,0.2222222222222222 ,0.9166666666666666 ,0.75 ,
    0.36363636363636365 ,0.6666666666666666 ,0.0 ,0.0 ,0.0 ,0.75 ,0.9666666666666667 ,0.3333333333333333 ,0.125 ,0.75 ,
    0.36363636363636365 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.25 ,1.0 ,0.8888888888888888 ,0.4583333333333333 ,0.5 ,
    0.18181818181818182 ,0.7777777777777778 ,0.0 ,0.0 ,0.5 ,0.0 ,1.0 ,1.0 ,0.041666666666666664 ,0.75 ,
    0.36363636363636365 ,0.7777777777777778 ,0.0 ,0.0 ,0.6428571428571429 ,0.125 ,0.7 ,0.8888888888888888 ,0.0 ,0.75 ,
    0.45454545454545453 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.125 ,0.9333333333333333 ,1.0 ,0.375 ,0.75 ,
    0.36363636363636365 ,0.6666666666666666 ,0.0 ,0.0 ,0.5 ,0.125 ,0.9 ,1.0 ,0.08333333333333333 ,0.75 ,
    0.45454545454545453 ,0.1111111111111111 ,0.0 ,0.0 ,1.0 ,0.75 ,1.0 ,0.6666666666666666 ,0.8333333333333334 ,0.75 ,
    0.36363636363636365 ,0.1111111111111111 ,0.0 ,0.0 ,0.5714285714285714 ,0.875 ,1.0 ,0.0 ,0.20833333333333334 ,0.75 ,
    0.45454545454545453 ,0.1111111111111111 ,1.0 ,0.0 ,0.5 ,0.125 ,1.0 ,1.0 ,0.041666666666666664 ,0.5 ,
    0.2727272727272727 ,0.6666666666666666 ,0.0 ,0.0 ,0.14285714285714285 ,0.875 ,1.0 ,0.7777777777777778 ,0.2916666666666667 ,0.75 ,
    0.7272727272727273 ,0.6666666666666666 ,0.0 ,0.0 ,0.5 ,0.375 ,0.6 ,0.8888888888888888 ,0.0 ,0.5 ,
    0.18181818181818182 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.375 ,0.8666666666666667 ,0.5555555555555556 ,0.20833333333333334 ,0.25 ,
    0.2727272727272727 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.5 ,0.8 ,0.8888888888888888 ,0.08333333333333333 ,0.75 ,
    0.2727272727272727 ,0.1111111111111111 ,0.0 ,0.0 ,0.5 ,0.375 ,0.9 ,1.0 ,0.16666666666666666 ,0.75 ,
    0.45454545454545453 ,0.1111111111111111 ,0.0 ,0.0 ,0.7857142857142857 ,0.875 ,1.0 ,0.1111111111111111 ,0.7083333333333334 ,0.5 ,
    0.6363636363636364 ,0.6666666666666666 ,0.0 ,0.0 ,0.5 ,0.0 ,1.0 ,1.0 ,0.625 ,0.5 ,
    0.18181818181818182 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.25 ,0.9 ,0.3333333333333333 ,0.08333333333333333 ,0.5 ,
    0.2727272727272727 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.625 ,0.9333333333333333 ,0.6666666666666666 ,0.0 ,0.5 ,
    0.2727272727272727 ,0.1111111111111111 ,0.0 ,0.0 ,0.0 ,0.625 ,0.9333333333333333 ,0.8888888888888888 ,0.9583333333333334 ,0.5 ,
    0.6363636363636364 ,0.1111111111111111 ,0.0 ,0.0 ,0.5 ,0.25 ,1.0 ,0.8888888888888888 ,0.08333333333333333 ,0.75 ,
    0.5454545454545454 ,0.6666666666666666 ,0.0 ,0.0 ,0.07142857142857142 ,0.75 ,1.0 ,1.0 ,0.25 ,0.75 ,
    0.2727272727272727 ,0.5555555555555556 ,0.0 ,0.0 ,0.0 ,0.25 ,0.9666666666666667 ,0.8888888888888888 ,0.7083333333333334 ,0.75 ,
    0.45454545454545453 ,0.6666666666666666 ,0.0 ,0.0 ,0.07142857142857142 ,0.125 ,1.0 ,1.0 ,1.0 ,0.5 ,
    0.36363636363636365 ,0.1111111111111111 ,0.0 ,0.0 ,0.6428571428571429 ,1.0 ,1.0 ,0.1111111111111111 ,0.25 ,0.75 ,
    0.36363636363636365 ,0.0 ,1.0 ,0.0 ,0.0 ,0.5 ,0.9333333333333333 ,0.3333333333333333 ,0.25 ,0.75 ;
    

    Matrixld E2(3,203);
    E2 << 0 ,1 ,1 ,0 ,1 ,1 ,0 ,0 ,1 ,1 ,1 ,0 ,1 ,0 ,1 ,0 ,0 ,0 ,1 ,0 ,1 ,1 ,1 ,1 ,1 ,1 ,0
 ,0 ,1 ,1 ,0 ,0 ,1 ,1 ,1 ,1 ,0 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,0 ,1 ,1 ,1 ,1 ,
1 ,1 ,1 ,1 ,0 ,1 ,1 ,1 ,1 ,0 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,0 ,1 ,1 ,1 ,0 ,1 ,0 ,1 
,0 ,0 ,1 ,1 ,1 ,1 ,1 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,1 ,0 ,0 ,0 ,0 ,0 ,0 ,0
 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,1 ,0 ,0 ,0 ,1 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,
0 ,0 ,1 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,1 ,0 ,0 ,0 ,0 ,0 ,0 ,1 ,0 ,1 ,0 ,0 ,0 ,0 ,0 ,0 ,1 
,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,0 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1
 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,0 , 1 ,0 ,0 ,1 ,0 ,0 ,1 ,1 ,0 ,
0 ,0 ,1 ,0 ,1 ,0 ,1 ,1 ,1 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,1 ,1 ,0 ,0 ,1 ,1 ,0 ,0 ,0 ,0 
,1 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,1 ,0 ,0 ,0 ,0 ,1
 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,1 ,0 ,0 ,0 ,1 ,0 ,1 ,0 ,1 ,1 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,
1 ,1 ,0 ,1 ,0 ,0 ,1 ,1 ,0 ,0 ,0 ,1 ,0 ,0 ,1 ,0 ,0 ,0 ,0 ,1 ,0 ,0 ,0 ,1 ,1 ,0 ,0 
,0 ,1 ,1 ,0 ,0 ,1 ,1 ,1 ,1 ,1 ,0 ,0 ,1 ,1 ,0 ,0 ,1 ,0 ,0 ,0 ,0 ,1 ,0 ,0 ,0 ,1 ,1
 ,0 ,0 ,1 ,0 ,0 ,1 ,0 ,0 ,1 ,0 ,1 ,0 ,0 ,1 ,1 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,1 ,
0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 
,0 ,0 ,0 ,0 ,0 ,0 ,0 , 0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0
 ,1 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,
0 ,0 ,0 ,1 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 
,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,1 ,1 ,0 ,0 ,1 ,0 ,1 ,1 ,0 ,0 ,1 ,1
 ,0 ,0 ,1 ,1 ,0 ,1 ,1 ,1 ,1 ,0 ,1 ,1 ,1 ,0 ,0 ,1 ,0 ,1 ,0 ,0 ,0 ,1 ,0 ,0 ,0 ,0 ,
0 ,1 ,1 ,0 ,0 ,1 ,1 ,0 ,1 ,1 ,0 ,1 ,0 ,1 ,1 ,1 ,0 ,0 ,0 ,1 ,0 ,1 ,1 ,0 ,1 ,0 ,0 
,0 ,0 ,1 ,1 ,0 ,0 ,1 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0
 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,1 ;

    reseauXOR.train_full(X2,E2,alpha,eps,iter_max,false);
    reseauXOR.save_to_file("Testsoftmax.json");
    // Test un peu
    RowVectorld T(10);
    T << 0.44444444, 0.        , 1.        , 0.        , 0.        ,
        0.57142857, 0.875     , 0.25      , 0.20833333, 0.75;

    // Attendu : 0,0,1

    cout << reseauXOR.predict(T) << endl;

    return 0;
}